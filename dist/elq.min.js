/**
 * @title elq.js
 * @overview Parses CSS for element queries, supports them in JavaScript
 * @copyright (c) 2014
 * @license CC BY (http://creativecommons.org/licenses/by/4.0/)
 * @author Art Lawry
*/
window.elq=function(a,b){"use strict";var c,d,e=100,f=0,g={},h={},i=new RegExp("\\s*([^,}]+)\\:media\\(((?:(?:(?:\\s*not)?\\s*(?:\\([^)]+\\))(?:\\s*and\\s*(?:\\([^)]+\\)))*)(?:\\s*,(?:\\s*not)\\s*(?:\\([^)]+\\))(?:\\s*and\\s*(?:\\([^)]+\\)))*)*|[^())]+))\\)","g"),j={};return a._revealed=j,j.fetchExternalCSS=function(a){var c,d,e=!1,h=a.getAttribute("href"),i=a.getAttribute("media")||"";return g[h+i]?f-=1:(e=!0,c=b.createElement("style"),d=new XMLHttpRequest,i&&c.setAttribute("media",i),c.setAttribute("href",h),c.className="elq-fetched",a.parentNode.insertBefore(c,a.nextSibling),g[h+i]=!0,d.onreadystatechange=function(){4===d.readyState&&(200===d.status?c.innerHTML+=d.responseText:j.unfetchExternalCSS(a),f-=1,f||j.parseCSS())},d.open("GET",h,!0),d.send()),e},j.unfetchExternalCSS=function(a){var b=!1,c=a.getAttribute("href"),d=a.getAttribute("media")||"",e=a.nextSibling;return e&&"style"===e.tagName.toLowerCase()&&a.getAttribute("href")===e.getAttribute("href")&&a.getAttribute("media")===e.getAttribute("media")&&"elq-fetched"===e.className&&(e.parentNode.removeChild(e),delete g[c+d],b=!0),b},j.applyContext=function(){var a,c,e,f=Object.keys(h),g=f.length;for(e=function(a,b,c,e,f){var g,i=h[a],j=Object.keys(i),k=j.length;for(g=0;k>g;g+=1)i[j[g]](e,f,c,b,d)},c=function(a){var c,d,f,g,h,i,j=b.querySelectorAll(a),k=j.length;for(c=0;k>c;c+=1)d=j[c],f=d.parentNode,g=b.defaultView.getComputedStyle(f,null).getPropertyValue("fontSize"),h=f.clientWidth,h+=2*(parseInt(f.style.padding,10)||0),h+=parseInt(f.style.paddingLeft,10)||0,h+=parseInt(f.style.paddingRight,10)||0,i=f.clientHeigparentHeightt,i+=2*(parseInt(f.style.padding,10)||0),i+=parseInt(f.style.paddingTop,10)||0,i+=parseInt(f.style.paddingBottom,10)||0,e(a,g,d,h,i)},a=0;g>a;a+=1)c(f[a]);return g?!0:!1},j.respondToContext=function(){var a=function(){var a=b.lastClientWidth||0,d=b.lastClientHeight||0;(b.clientWidth!==a||b.clientHeight!==d)&&(clearTimeout(c),c=setTimeout(j.respondToContext,100),b.lastClientWidth=b.clientWidth,b.lastClientHeight=b.clientHeight)};return d=b.defaultView.getComputedStyle(b.querySelector("html"),null).getPropertyValue("fontSize"),window.removeEventListener("resize",a),window.removeEventListener("orientationchange",a),window.addEventListener("resize",a),window.addEventListener("orientationchange",a),j.applyContext()},j.parseCSS=function(){var c,d,e,f=!1,g=b.querySelectorAll("style"),h=g.length,k=function(b,c,d){return c+"."+a.register(c,d)};for(c=0;h>c;c+=1){for(d=g[c],e=d.innerHTML,e=e.replace(/\s+/g," "),e=e.replace(/(^|\})\s*/g,"$1\n");i.test(e);)f=!0,e=e.replace(i,k);d.innerHTML=e}return j.respondToContext(),f},j.mediaToCondition=function(a){for(a="("+a+")",a=a.replace(/\s*,\s*/g,")||("),a=a.replace(/\s*not\s*([^|]+)\s*/g,"!($1)"),a=a.replace(/\s+and\s+/g,"&&"),a=a.replace(/\s*(?:(min|max)-)?(width|height)\s*:\s*(\d+)(px|em|rem)\s*/g,function(a,b,c,d,e){var f,g,h;return f="min"===b?">=":"max"===b?"<=":"==",g="width"===c?"elw":"elh",h=d,"em"===e?g="("+g+"/pxpem)":"rem"===e&&(g="("+g+"/pxprem)"),g+f+h}),a=a.replace(/\s*(?:(min|max)-)?aspect-ratio\s*:\s*(\S+)\s*/g,function(a,b,c){var d,e,f;return d="min"===b?">=":"max"===b?"<=":"==",e="(elw/elh)",f=c,e+d+f});/\(\(([^)]+)\)\)/.test(a);)a=a.replace(/\(\(([^)]+)\)\)/g,"($1)");return a},a.register=function(a,b,c){return a&&b&&(c||(c=b.replace(/^\W*(\w.*\w)\W*$/,function(a,b){return b=b.replace(/\W+/g,"-"),"elq-"+b})),h[a]||(h[a]={}),h[a][b]=new Function("elw","elh","el","pxpem","pxprem","el.className = el.className.replace(/(^|\\s)"+c+"($|\\s)/g,'$2');if ("+j.mediaToCondition(b)+") {el.className += el.className ? ' ' : '';el.className += '"+c+"';}")),j.respondToContext(),c},a.unregister=function(a,b){var c=!1;return a&&b?(c=h[a][b]?!0:!1,delete h[a][b]):(c=Object.keys(h).length?!0:!1,h={}),c},a.process=function(a){var c,d;if(a=a||b.querySelectorAll('link[href*=".css"]'),c=a.length,f=c,c)for(d=0;c>d;d+=1)j.fetchExternalCSS(a[d]);else j.parseCSS();return!0},a.respondAfter=function(a){return e=+a>=0?a:e},a}(window.elq||{},document);
//# sourceMappingURL=elq.min.js.map